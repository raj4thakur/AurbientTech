{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aurbient AI Readiness Assessment</title>

    <!-- Tailwind (if already loaded globally, remove) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      .btn-primary {
        background: linear-gradient(90deg, #6C47FF, #9A5CFF);
        color: white;
        padding: 12px 28px;
        border-radius: 9999px;
        font-weight: 600;
      }
      .btn-primary:hover { opacity: 0.9; }

      .btn-secondary {
        border: 2px solid #6C47FF;
        color: #6C47FF;
        padding: 12px 28px;
        border-radius: 9999px;
        font-weight: 600;
        background: white;
      }
      .btn-secondary:hover { background: #f3eaff; }

      .gradient-card {
        background: linear-gradient(135deg, #ffffff, #f8f5ff);
      }
    </style>
</head>

<body class="bg-gray-50">

<!-- HERO SECTION -->
<section class="py-20 bg-white">
  <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-10 items-center">
    
    <div class="space-y-6">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 leading-tight">
        Measure Your <span class="text-purple-600">AI Readiness</span>  
        <br/>Identify Automation Opportunities
      </h1>

      <p class="text-lg text-gray-600">
        Evaluate your organization‚Äôs data, processes, technology, culture, 
        and automation potential. Receive a personalized AI Readiness Score, 
        improvement roadmap, and top automation opportunities.
      </p>

      <div class="flex gap-4 pt-3">
        <a href="#assessment" class="btn-primary">Start Assessment</a>
        <a href="/contact" class="btn-secondary">Book Consultation</a>
      </div>

      <div class="flex gap-4 pt-4">
        <div class="flex items-center gap-2">
          <span class="text-purple-600 text-xl">‚òÖ</span>
          <span class="text-gray-700">4.9/5 Client Satisfaction</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-purple-600 text-xl">üèÜ</span>
          <span class="text-gray-700">AI Excellence Award 2023</span>
        </div>
      </div>
    </div>

    <div class="rounded-3xl overflow-hidden shadow-xl">
      <img src="https://tse1.mm.bing.net/th/id/OIP.Ee8BjFmWpewXln08VTSq0QHaEK?rs=1&pid=ImgDetMain&o=7&rm=3" class="w-full h-full object-cover">
    </div>

  </div>
</section>


<!-- ASSESSMENT WIZARD -->
<section id="assessment" class="py-20">
  <div class="max-w-3xl mx-auto px-6">

    <!-- Card -->
    <div id="intro" class="gradient-card p-10 rounded-3xl shadow-lg">

      <h2 class="text-3xl font-bold text-gray-900 mb-4">Begin Your AI Assessment</h2>
      <p class="text-gray-600 mb-6">
        Answer a short set of questions (2‚Äì3 minutes).  
        Receive an instant readiness score and tailored recommendations.
      </p>

      <label class="block text-gray-700 font-medium mb-2">Company Name (optional)</label>
      <input id="client_name" type="text"
         class="w-full border border-gray-300 rounded-xl p-4 focus:border-purple-500 focus:ring-purple-500"
         placeholder="e.g., Aurbient Technologies" />

      <button id="startBtn" class="btn-primary w-full mt-6 text-center">
        Start Assessment
      </button>
    </div>


    <!-- INTERVIEW SECTION -->
    <div id="interview" class="hidden mt-12 gradient-card p-10 rounded-3xl shadow-lg">
      <div class="text-sm text-gray-500 mb-4">
         Question <span id="qnum">0</span> of <span id="total">0</span>
      </div>

      <h3 id="pillarTitle" class="text-2xl font-bold text-purple-700"></h3>
      <p id="questionText" class="text-gray-700 mt-2"></p>

      <textarea id="answer" rows="4"
        class="w-full mt-6 border border-gray-300 rounded-xl p-4 focus:border-purple-500 focus:ring-purple-500"
        placeholder="Your response...">
      </textarea>

      <button id="submitAnswer" class="btn-primary w-full mt-6">
        Submit Answer
      </button>
    </div>


    <!-- RESULT SECTION -->
    <div id="result" class="hidden mt-12 gradient-card p-10 rounded-3xl shadow-lg">
      <h2 class="text-3xl font-bold text-gray-900 mb-6">Your Assessment Results</h2>

      <div id="scoreSummary" class="space-y-5"></div>

      <div id="recommendations" class="mt-10"></div>
    </div>

  </div>
</section>


<!-- FOOTER CTA -->
<section class="py-20 bg-white">
  <div class="max-w-4xl mx-auto text-center px-6">
    <h2 class="text-3xl md:text-4xl font-bold text-gray-900">
      Ready to Increase Efficiency With AI?
    </h2>
    <p class="text-lg text-gray-600 mt-3">
      Book a strategy call to explore automations, AI agents, or predictive analytics for your workflows.
    </p>

    <div class="flex justify-center mt-6">
      <a href="/contact" class="btn-primary">Book AI Consultation</a>
    </div>
  </div>
</section>


<!-- JS LOGIC (CONNECTS TO DJANGO API) -->
<script>
const startBtn = document.getElementById("startBtn");
const submitBtn = document.getElementById("submitAnswer");

let totalCount = 0;
let currentQuestion = null;

startBtn.addEventListener("click", async () => {
  const resp = await fetch("{% url 'assessments:api_start' %}", {
    method: "POST",
    headers: { "X-CSRFToken": "{{ csrf_token }}" }
  });

  const data = await resp.json();
  totalCount = data.total;
  document.getElementById("total").textContent = totalCount;
  loadQuestion(data.next_question, 1);

  document.getElementById("intro").classList.add("hidden");
  document.getElementById("interview").classList.remove("hidden");
});


async function loadQuestion(q, number) {
  currentQuestion = q;
  document.getElementById("qnum").textContent = number;
  document.getElementById("pillarTitle").textContent = q.pillar_title;
  document.getElementById("questionText").textContent = q.question;
  document.getElementById("answer").value = "";
}


submitBtn.addEventListener("click", async () => {
  const answer = document.getElementById("answer").value.trim();
  if (!answer) { alert("Please enter an answer."); return; }

  const clientName = document.getElementById("client_name")?.value || "";

  const resp = await fetch("{% url 'assessments:api_answer' %}", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-CSRFToken": "{{ csrf_token }}"
    },
    body: JSON.stringify({ answer, client_name: clientName })
  });

  const data = await resp.json();
  if (data.next_question) {
    loadQuestion(data.next_question, (data.progress || 0) + 1);
  } else if (data.result) {
    showResult(data.result);
  }
});


function showResult(result) {
  document.getElementById("interview").classList.add("hidden");
  document.getElementById("result").classList.remove("hidden");

  const summary = document.getElementById("scoreSummary");
  summary.innerHTML = `
      <p class="text-xl">
        <strong class="text-purple-700 text-4xl">${result.ai_index}/25</strong>  
        <span class="text-gray-700 ml-2">‚Äî ${result.classification}</span>
      </p>
  `;

  for (const [k, v] of Object.entries(result.pillars)) {
    summary.innerHTML += `
      <div class="p-5 rounded-2xl bg-white shadow-sm">
        <strong>${v.title}</strong>: 
        <span class="text-purple-700 font-semibold">${v.score}/5</span>
      </div>
    `;
  }

  const rec = document.getElementById("recommendations");
  rec.innerHTML = `<h3 class="text-2xl font-bold text-gray-900">Recommendations</h3>`;

  const ul = document.createElement("ul");
  ul.className = "list-disc pl-6 mt-4 space-y-2";

  (result.recommendations.opportunities || []).forEach((o) => {
    const li = document.createElement("li");
    li.textContent = o;
    ul.appendChild(li);
  });
  rec.appendChild(ul);

  if (result.recommendations.roadmap) {
    const r = result.recommendations.roadmap;
    rec.innerHTML += `
      <h4 class="text-xl font-bold mt-8">Roadmap</h4>
      <p class="mt-3"><strong>30-Day:</strong> ${r["30_day"]}</p>
      <p><strong>90-Day:</strong> ${r["90_day"]}</p>
      <p><strong>6-Month:</strong> ${r["6_month"]}</p>
    `;
  }
}
</script>

</body>
</html>
